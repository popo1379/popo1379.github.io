<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      Android开发：RecyclerView实现简单瀑布流效果 | popo1379的个人博客 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="popo1379">
    
    

    <meta name="description" content="RecyclerView是谷歌随着Android 5.0推出的全新控件，RecyclerView提供了一种拔插式的体验，相较于它的前代ListView具有低耦合，扩展性强的特点，现在越来越多的开发者放弃listView转而使用RecyclerView，RecyclerView控件也可以实现更多更强大的功能，瀑布流就是其中的一种。
前段时间想用listview实现一个非常简单电话薄功能，后来发现用瀑">
<meta property="og:type" content="article">
<meta property="og:title" content="Android开发：RecyclerView实现简单瀑布流效果 | popo1379的个人博客">
<meta property="og:url" content="https://popo1379.github.io/2016/11/04/2016-11-4/index.html">
<meta property="og:site_name" content="popo1379的个人博客">
<meta property="og:description" content="RecyclerView是谷歌随着Android 5.0推出的全新控件，RecyclerView提供了一种拔插式的体验，相较于它的前代ListView具有低耦合，扩展性强的特点，现在越来越多的开发者放弃listView转而使用RecyclerView，RecyclerView控件也可以实现更多更强大的功能，瀑布流就是其中的一种。
前段时间想用listview实现一个非常简单电话薄功能，后来发现用瀑">
<meta property="og:updated_time" content="2016-11-04T10:07:56.286Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android开发：RecyclerView实现简单瀑布流效果 | popo1379的个人博客">
<meta name="twitter:description" content="RecyclerView是谷歌随着Android 5.0推出的全新控件，RecyclerView提供了一种拔插式的体验，相较于它的前代ListView具有低耦合，扩展性强的特点，现在越来越多的开发者放弃listView转而使用RecyclerView，RecyclerView控件也可以实现更多更强大的功能，瀑布流就是其中的一种。
前段时间想用listview实现一个非常简单电话薄功能，后来发现用瀑">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">popo1379的个人博客</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          where there‘s a will,there&#39;s a way.
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">Android开发：RecyclerView实现简单瀑布流效果</h1>

    

    <div class="post-meta">
      <time datetime="2016-11-04" class="post-meta__date date">2016-11-04</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/android开发/">android开发</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>RecyclerView是谷歌随着Android 5.0推出的全新控件，RecyclerView提供了一种拔插式的体验，相较于它的前代ListView具有低耦合，扩展性强的特点，现在越来越多的开发者放弃listView转而使用RecyclerView，<br>RecyclerView控件也可以实现更多更强大的功能，瀑布流就是其中的一种。</p>
<p>前段时间想用listview实现一个非常简单电话薄功能，后来发现用瀑布流更美观更显目，完成后把代码发上来，就当一篇加深印象的学习笔记，日后有需求还可以来看看。</p>
<a id="more"></a>
<p>想要实现RecyclerView功能，首先要在Gradle中添加依赖包：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.android.support:recyclerview-v7:+'</span></div></pre></td></tr></table></figure></p>
<p>同时为了更美观的实现瀑布流效果，我们使用了cardview作为控件中的item<br>添加依赖包：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.android.support:cardview-v7:21.0.3'</span></div></pre></td></tr></table></figure></p>
<p>如果你熟悉listview,那么RecyclerView上手一样简单，在布局上基本和listview相同：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></div><div class="line">       <span class="attr">android:id</span>=<span class="string">"@+id/tellbook_rv"</span></div><div class="line">       <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">       <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">       <span class="attr">android:scrollbars</span>=<span class="string">"vertical"</span></div><div class="line">       &gt;</div></pre></td></tr></table></figure>
<p>子布局：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">xmlns:card_view</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.CardView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/card_view"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"150dp"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">card_view:cardUseCompatPadding</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">card_view:cardCornerRadius</span>=<span class="string">"10dp"</span></div><div class="line">        <span class="attr">card_view:cardBackgroundColor</span>=<span class="string">"#FF9900"</span> &gt;</div><div class="line"><span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/tellbook_name"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:textSize</span>=<span class="string">"20sp"</span></div><div class="line">    <span class="attr">android:gravity</span>=<span class="string">"center"</span></div><div class="line">    /&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">android.support.v7.widget.CardView</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>代码部分：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TellBookActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt;tellBooklist=<span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle saveInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(saveInstanceState);</div><div class="line">        setContentView(R.layout.tellbook_layout);</div><div class="line">        <span class="comment">//初始化数据</span></div><div class="line">        initTellbook();</div><div class="line">        <span class="comment">//设置RecyclerView</span></div><div class="line">        RecyclerView tellbook_RV=(RecyclerView)findViewById(R.id.tellbook_rv);</div><div class="line">        <span class="comment">//固定控件大小提高性能</span></div><div class="line">        tellbook_RV.setHasFixedSize(<span class="keyword">true</span>);</div><div class="line">        <span class="comment">//数据传入构造器</span></div><div class="line">        TellbookAdapter adapter=<span class="keyword">new</span> TellbookAdapter(TellBookActivity.<span class="keyword">this</span>,tellBooklist);</div><div class="line">        <span class="comment">//组合配适器</span></div><div class="line">        tellbook_RV.setAdapter(adapter);</div><div class="line">        <span class="comment">//设置布局管理器</span></div><div class="line">        <span class="comment">//列数为两列</span></div><div class="line">        <span class="keyword">int</span> spanCount = <span class="number">3</span>;</div><div class="line">        <span class="comment">//设置布局为瀑布流</span></div><div class="line">       StaggeredGridLayoutManager mLayoutManager = <span class="keyword">new</span> StaggeredGridLayoutManager(</div><div class="line">                spanCount,</div><div class="line">                StaggeredGridLayoutManager.VERTICAL);</div><div class="line">        tellbook_RV.setLayoutManager(mLayoutManager);</div><div class="line">        <span class="comment">//设置Toolbar</span></div><div class="line">        Toolbar tellbook_toolbar=(Toolbar)findViewById(R.id.tellbook_toolbar);</div><div class="line"></div><div class="line">        tellbook_toolbar.setTitle(<span class="string">"化工学院各办公室电话查询(仅演示功能)"</span>);</div><div class="line">        setSupportActionBar(tellbook_toolbar);</div><div class="line">        tellbook_toolbar.setNavigationIcon(R.drawable.abc_ic_ab_back_mtrl_am_alpha);</div><div class="line">        tellbook_toolbar.setNavigationOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</div><div class="line">            <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">            onBackPressed();</div><div class="line">        &#125;</div><div class="line">        &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initTellbook</span><span class="params">()</span></span>&#123;</div><div class="line">    String number1=<span class="keyword">new</span> String(<span class="string">"党委办公室、校长办公室：63083027"</span>);</div><div class="line">    tellBooklist.add(number1);</div><div class="line">    String number2=<span class="keyword">new</span> String(<span class="string">"招生电话：本(专)科生:0432-63083056"</span>);</div><div class="line">   tellBooklist.add(number2);</div><div class="line">    String number3=<span class="keyword">new</span> String(<span class="string">"研究生:0432-63081060"</span>);</div><div class="line">    tellBooklist.add(number3);</div><div class="line">    String number4=<span class="keyword">new</span> String (<span class="string">"图书馆：63083149"</span>);</div><div class="line">    tellBooklist.add(number4</div><div class="line">    );</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>配适器：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TellbookAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">TellbookAdapter</span>.<span class="title">MyViewHolder</span>&gt;</span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; mDatas;</div><div class="line">    <span class="keyword">private</span> Context mContext;</div><div class="line">    <span class="keyword">private</span> LayoutInflater inflater;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TellbookAdapter</span><span class="params">(Context context, List&lt;String&gt; datas)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.mContext=context;</div><div class="line">        <span class="keyword">this</span>.mDatas=datas;</div><div class="line">        inflater=LayoutInflater.from(mContext);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//得到所需Item数量</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> mDatas.size();</div><div class="line">    &#125;</div><div class="line"><span class="comment">//这个方法主要生成为每个Item inflater出一个View，但是该方法返回的是一个ViewHolder。</span></div><div class="line">    <span class="function"><span class="keyword">public</span> MyViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</div><div class="line"></div><div class="line">        View view = inflater.inflate(R.layout.tellbook_item,parent, <span class="keyword">false</span>);</div><div class="line">        MyViewHolder holder= <span class="keyword">new</span> MyViewHolder(view);</div><div class="line">        <span class="keyword">return</span> holder;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 这个方法主要用于适配渲染数据到View中。</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(MyViewHolder holder, <span class="keyword">final</span> <span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line"></div><div class="line">        holder.tv.setText( mDatas.get(position));</div><div class="line">        <span class="comment">//设置瀑布流高度</span></div><div class="line">        holder.tv.setHeight(<span class="number">200</span> + (position % <span class="number">3</span>) * <span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span></span></div><div class="line">    &#123;</div><div class="line"></div><div class="line">        TextView tv;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MyViewHolder</span><span class="params">(View view)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">super</span>(view);</div><div class="line">            tv = (TextView) view.findViewById(R.id.tellbook_name);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

  </section>

  <section class="post-comments">

    <!-- 将评论系统（例如Disqus、多说、友言、畅言等）提供的代码片段粘贴在这里 -->
    
</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
